{% extends "./base.html" %}

{% block content %}

    <div class="auth-page">
        <div class="auth-card">
            <div id="register-view" >
                <h2 style="color: var(--bs-text)">Rejoindre JobBaord</h2>

                <form method='post'>

                    {% csrf_token %}

                    {{ form.role }} 
                    
                    <div class="form-group role-selector">
                        <label>Je m'inscris en tant que :</label>
                        <div class="role-options">
                            <button type="button" class="role-btn active" data-role="candidate" onclick="selectRole(this, 'candidate')">
                                <i class="fas fa-user-tie"></i> Candidat
                            </button>
                            <button type="button" class="role-btn" data-role="employer" onclick="selectRole(this, 'employer')">
                                <i class="fas fa-building"></i> Employeur
                            </button>
                        </div>
                    </div>

                    <div class="form-group" id="name-field">
                        <label for="reg-name">Nom Complet</label>
                        {{ form.username }}
                        {% if form.username.errors %}
                            <div
                                class"error"
                                style="color: red;display:flex;gap:5px;justify-content:center;align-items:center;font-size: 15px;">
                                    <i class="bi bi-exclamation-triangle"></i> {{ form.username.errors }}
                            </div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label for="reg-email">Adresse Email</label>
                        {{ form.email }}
                        {% if form.email.errors %}
                            <div
                                class"error"
                                style="color: red;display:flex;gap:5px;justify-content:center;align-items:center;font-size: 15px;">
                                <i class="bi bi-exclamation-triangle"></i> {{ form.email.errors }}
                            </div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Mot de passe</label>
                        {{ form.password }}
                        {% if form.password.errors %}
                            <div
                                class"error"
                                style="color: red;display:flex;gap: 5px;justify-content:center;align-items:center;font-size: 15px;">
                                <i class="bi bi-exclamation-triangle"></i> {{ form.password.errors }}
                            </div>
                        {% endif %}
                    </div>

                    <button type="submit" class="btn-primary" style="width:100%; margin-top: 15px;">M'inscrire</button>
                </form>

                <p class="switch-link">
                    Déjà un compte ?
                    <a href="{% url "login" %}" style="font-weight: bold; color: var(--bs-primary);">Se connecter</a>
                </p>
            </div>
        </div>
    </div>

    <script>
        let currentRole = 'candidate';

        function selectRole(button, role) {
            currentRole = role;
            document.querySelectorAll('.role-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');

            const roleInput = document.getElementById('id_role');
            if (roleInput) {
                roleInput.value = role;
            }

            updateRegistrationFields(role);
        }

        function updateRegistrationFields(role) {
            const nameField = document.getElementById('name-field');
            const name_input = document.querySelector('#name-field input');
            const name_label = document.querySelector('#name-field label');
            
            if (role === 'candidate') {
                name_input.placeholder = "Nom complet";
                name_label.textContent = "Nom complet";
            } else {
                name_input.placeholder = "Nom de l'entreprise";
                name_label.textContent = "Nom de l'entreprese";
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            selectRole(document.querySelector(`[data-role="${currentRole}"]`), currentRole);
        });
    </script>

{% endblock %}
